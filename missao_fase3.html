<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A.I.D. - Sincroniza√ß√£o</title>
    <style>
        body {
            background-color: #0d0d0d;
            color: #00ff41;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
            user-select: none;
            box-sizing: border-box;
        }

        #console-missao {
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
            text-align: center;
        }

        h2 { border-bottom: 1px dashed #00ff41; padding-bottom: 10px; font-size: 20px; }
        p { font-size: 14px; }

        .game-board {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 15px;
            /* MOBILE: Em telas pequenas, muda para coluna √∫nica */
            flex-wrap: wrap; 
        }

        .coluna {
            display: flex;
            flex-direction: column;
            gap: 15px;
            flex: 1; /* Ocupa espa√ßo igual */
            min-width: 250px; /* Se ficar muito pequeno, quebra linha */
        }

        .card-dado, .card-grafico {
            background-color: #001a00;
            border: 2px solid #005500;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.3s;
            font-size: 14px;
            display: flex; align-items: center; justify-content: center;
            min-height: 80px;
        }

        .card-dado:hover, .card-grafico:hover { border-color: #00ff41; }
        .selecionado { background-color: #003300; border-color: #ffff00; color: #ffff00; }
        .resolvido { opacity: 0.5; pointer-events: none; border-color: #00ff41; background-color: #000; }

        /* √çcones CSS */
        .icon-pizza { width: 40px; height: 40px; border-radius: 50%; background: conic-gradient(#00ff41 0% 30%, #005500 30% 70%, #fff 70% 100%); border: 2px solid #00ff41; margin-bottom:5px; display:inline-block;}
        .icon-barras { display: flex; align-items: flex-end; gap: 3px; height: 40px; margin-bottom:5px; display:inline-block;}
        .bar { width: 8px; background-color: #00ff41; display:inline-block; }
        .icon-linha { width: 40px; height: 40px; border-left: 2px solid #00ff41; border-bottom: 2px solid #00ff41; margin-bottom:5px; display:inline-block; position: relative;}
        .icon-linha::after { content:''; position:absolute; top:0; left:0; width:100%; height:100%; background: linear-gradient(45deg, transparent 48%, #00ff41 48%, #00ff41 52%, transparent 52%); }

        #agente-sigma { margin-top: 20px; border: 1px solid #00ff41; padding: 10px; background-color: #000; color: #ccffcc; min-height: 40px; font-size: 14px;}
        
        #btn-proximo {
            display: none; margin-top: 20px; padding: 15px 30px; background-color: #00ff41; color: #000; font-weight: bold; border: none; cursor: pointer; width: 100%;
        }
    </style>
</head>
<body>
  
    <script>
        // CRON√îMETRO DE FASE
        // Salva a hora que a p√°gina carregou
        const inicioFase = Date.now();
    </script>


    <div id="console-missao">
        <h2>üîÑ SINCRONIZA√á√ÉO DE DADOS</h2>
        <p>Instru√ß√£o: Clique no DADO (Esquerda) e depois no GR√ÅFICO IDEAL (Direita).</p>

        <div class="game-board">
            <div class="coluna" id="coluna-dados">
                <div class="card-dado" data-tipo="tempo" onclick="selecionarDado(this)">
                    üìÇ DADO A01:<br>
                    "Varia√ß√£o da temperatura do servidor ao longo de 24 horas."
                </div>

                <div class="card-dado" data-tipo="partes" onclick="selecionarDado(this)">
                    üìÇ DADO B02:<br>
                    "Distribui√ß√£o do or√ßamento: 50% Seguran√ßa, 30% Hardware, 20% Caf√©."
                </div>

                <div class="card-dado" data-tipo="comparacao" onclick="selecionarDado(this)">
                    üìÇ DADO C03:<br>
                    "Compara√ß√£o da quantidade de hacks feitos pelo Agente A vs Agente B."
                </div>
            </div>

            <div class="coluna" id="coluna-graficos">
                
                <div class="card-grafico" data-tipo="partes" onclick="selecionarGrafico(this)">
                    <div style="text-align:center">
                        <div class="icon-pizza"></div>
                        <small>Setores (Pizza)</small>
                    </div>
                </div>

                <div class="card-grafico" data-tipo="tempo" onclick="selecionarGrafico(this)">
                    <div style="text-align:center">
                        <div class="icon-linha"></div>
                        <small>Linhas</small>
                    </div>
                </div>

                <div class="card-grafico" data-tipo="comparacao" onclick="selecionarGrafico(this)">
                    <div style="text-align:center">
                        <div class="icon-barras">
                            <div class="bar" style="height: 20px"></div>
                            <div class="bar" style="height: 40px"></div>
                            <div class="bar" style="height: 30px"></div>
                        </div>
                        <small>Colunas</small>
                    </div>
                </div>

            </div>
        </div>




        <div id="agente-sigma">
            <strong>üïµÔ∏è AGENTE SIGMA:</strong>
            <span id="msg-sigma">Selecione um pacote de dados.</span>
        </div>

        <button id="btn-proximo" onclick="finalizarFase()">PROSSEGUIR PARA PR√ìXIMA FASE >></button>
    </div>

    <script>
        let dadoSelecionado = null;
        let acertos = 0;

        function selecionarDado(elemento) {
            if (elemento.classList.contains('resolvido')) return;
            document.querySelectorAll('.card-dado').forEach(el => el.classList.remove('selecionado'));
            elemento.classList.add('selecionado');
            dadoSelecionado = elemento;
            document.getElementById('msg-sigma').innerText = "Agora escolha o gr√°fico correspondente.";
        }

function selecionarGrafico(elementoGrafico) {
            if (!dadoSelecionado) {
                document.getElementById('msg-sigma').innerText = "‚ö†Ô∏è Clique num texto primeiro!";
                return;
            }
            let tipoDado = dadoSelecionado.getAttribute('data-tipo');
            let tipoGrafico = elementoGrafico.getAttribute('data-tipo');

            if (tipoDado === tipoGrafico) {
                // --- ACERTO ---
                acertos++;
                dadoSelecionado.classList.remove('selecionado');
                dadoSelecionado.classList.add('resolvido');
                dadoSelecionado.innerHTML += " ‚úÖ";
                
                document.getElementById('msg-sigma').innerText = "Sincroniza√ß√£o correta!";
                document.getElementById('msg-sigma').style.color = "#ffff00";
                
                // REGISTRO DE ACERTO (Apenas uma vez)
                registrarLog("Associa√ß√£o Correta: " + tipoDado);

                dadoSelecionado = null;

                if (acertos === 3) {
                    document.getElementById('msg-sigma').innerHTML = "SISTEMA 100% OPERACIONAL.";
                    document.getElementById('btn-proximo').style.display = "inline-block";
                }

            } else {
                // --- ERRO ---
                let sigma = document.getElementById('agente-sigma');
                
                // Anima√ß√£o de tremor
                sigma.classList.remove('erro-anim');
                void sigma.offsetWidth; 
                sigma.classList.add('erro-anim');

                // Feedback Visual
                let msgErro = "Incompat√≠vel! ";
                if (tipoGrafico === 'partes') msgErro += "Pizza √© ruim para comparar ou ver tempo. Use Pizza apenas para porcentagens de um total.";
                if (tipoGrafico === 'tempo') msgErro += "Linha √© para continuidade (tempo). N√£o serve para comparar categorias soltas.";
                
                document.getElementById('msg-sigma').innerText = msgErro + " Tente novamente.";
                document.getElementById('msg-sigma').style.color = "#ff3333";

                // REGISTRO DE ERRO (Apenas uma vez)
                // Removemos a linha antiga duplicada e deixamos apenas esta:
                registrarLog("[MISS√ÉO 3] Erro de Associa√ß√£o: Tentou ligar '" + tipoDado + "' com gr√°fico de '" + tipoGrafico + "'", "erro");
            }
        }



        function finalizarFase() { window.location.href = "missao_fase4.html"; }

        // FUN√á√ÉO DE LOG INTELIGENTE
        function registrarLog(texto, tipo = "info") {
            // Calcula tempo decorrido desde que a p√°gina abriu
            let tempoDecorrido = ((Date.now() - inicioFase) / 1000).toFixed(1); // Segundos

            // Formata a linha do log
            let prefixo = "[" + document.title.replace("A.I.D. - ", "") + " | " + tempoDecorrido + "s] ";
            let linha = prefixo + texto;

            // Salva no relat√≥rio
            let logAtual = localStorage.getItem('AID_Relatorio') || "";
            localStorage.setItem('AID_Relatorio', logAtual + linha + "\n");

            // Se for erro, incrementa o contador global
            if (tipo === "erro") {
                let totalErros = parseInt(localStorage.getItem('AID_TotalErros') || 0);
                localStorage.setItem('AID_TotalErros', totalErros + 1);
            }
        }


    </script>
    <script src="footer.js"></script>

</body>
</html>