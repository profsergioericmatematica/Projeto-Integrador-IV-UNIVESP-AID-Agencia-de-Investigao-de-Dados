<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A.I.D. - Miss√£o Cofre Digital V2</title>

    <style>
        /* --- ESTILO (CSS) --- */
        body {
            background-color: #0d0d0d;
            color: #00ff41; 
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column; /* <--- ESSA LINHA CONSERTA O LAYOUT */
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
            box-sizing: border-box;
        }

        #container-jogo {
            width: 100%;
            max-width: 450px;
            border: 2px solid #00ff41;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.5);
            text-align: center;
            position: relative;
            /* Margem autom√°tica para garantir que o jogo fique centralizado e o rodap√© no final */
            margin-top: auto; 
            margin-bottom: auto;
        }

        #info-topo {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 10px;
            color: #fff;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }

        #tela-display {
            background-color: #003b00;
            color: #fff;
            padding: 15px;
            font-size: 24px;
            margin-bottom: 20px;
            border: 1px solid #00ff41;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }

        #agente-sigma-box {
            border-top: 1px dashed #00ff41;
            margin-top: 20px;
            padding-top: 10px;
            font-size: 14px;
            color: #ccffcc;
            min-height: 80px;
        }

        .teclado {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        button {
            background-color: #1a1a1a;
            color: #00ff41;
            border: 1px solid #00ff41;
            padding: 15px;
            font-size: 18px;
            cursor: pointer;
            font-family: inherit;
            transition: 0.2s;
        }

        button:hover {
            background-color: #00ff41;
            color: #000;
        }

        /* Bot√£o Pr√≥xima Fase */
        #btn-proxima-fase {
            display: none;
            width: 100%;
            background-color: #fff;
            color: #000;
            font-weight: bold;
            margin-top: 20px;
            animation: piscar 1s infinite alternate;
        }

        .btn-hack {
            background-color: #ffff00; 
            color: #000;
            border: 2px solid #fff;
            font-weight: bold;
            display: none;
            width: 100%;
            margin-top: 10px;
        }
        .btn-hack:hover {
            background-color: #ffcc00;
        }

        #area-pergunta {
            display: none;
            flex-direction: column;
            gap: 10px;
        }

        .btn-resposta {
            width: 100%;
            margin-bottom: 5px;
        }

        .texto-destaque {
            color: #ffff00;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        @keyframes piscar { from { opacity: 1; } to { opacity: 0.7; } }
    </style>
</head>
<body>

        <script>
            // CRON√îMETRO DE FASE
            // Salva a hora que a p√°gina carregou
            const inicioFase = Date.now();
        </script>

    <div id="container-jogo">
        <div id="info-topo">
            <span>üîí V2.0</span>
            <span id="contador-tentativas">Tentativas: 0</span>
        </div>

        <h2>COFRE DIGITAL</h2>
        
        <div id="tela-display">SISTEMA BLOQUEADO</div>

        <div id="teclado-numerico" class="teclado">
            <button onclick="verificarChute(1)">1</button>
            <button onclick="verificarChute(2)">2</button>
            <button onclick="verificarChute(3)">3</button>
            <button onclick="verificarChute(4)">4</button>
            <button onclick="verificarChute(5)">5</button>
            <button onclick="verificarChute(6)">6</button>
            <button onclick="verificarChute(7)">7</button>
            <button onclick="verificarChute(8)">8</button>
            <button onclick="verificarChute(9)">9</button>
            <button onclick="verificarChute(0)">0</button>
        </div>

        <button id="btn-hack" class="btn-hack" onclick="revelarSenha()">üîì EXECUTAR DECODIFICADOR</button>
        
        <button id="btn-proxima-fase" onclick="irProximaFase()">PROSSEGUIR PARA PR√ìXIMA FASE >></button>

        <div id="area-pergunta">
            <p>O sistema reiniciou! A chance de acertar agora √© MAIOR, MENOR ou IGUAL?</p>
            <button class="btn-resposta" onclick="verificarRespostaPedagogica('mudou')">A chance MUDOU (Maior ou Menor)</button>
            <button class="btn-resposta" onclick="verificarRespostaPedagogica('igual')">A chance continua IGUAL</button>
        </div>

        <div id="agente-sigma-box">
            <strong>üïµÔ∏è AGENTE SIGMA:</strong>
            <p id="mensagem-sigma">Agente, precisamos da senha (0-9). A chance √© de 1/10. Fa√ßa uma tentativa!</p>
        </div>
    </div>

    <script>
        var numeroSecreto = Math.floor(Math.random() * 10);
        var ultimoChuteErrado = -1;
        var totalTentativas = 0; 

        function atualizarContador() {
            document.getElementById("contador-tentativas").innerText = "Tentativas: " + totalTentativas;
        }

        // FUN√á√ÉO DE LOG INTELIGENTE
        function registrarLog(texto, tipo = "info") {
            // Calcula tempo decorrido desde que a p√°gina abriu
            let tempoDecorrido = ((Date.now() - inicioFase) / 1000).toFixed(1); // Segundos

            // Formata a linha do log
            let prefixo = "[" + document.title.replace("A.I.D. - ", "") + " | " + tempoDecorrido + "s] ";
            let linha = prefixo + texto;

            // Salva no relat√≥rio
            let logAtual = localStorage.getItem('AID_Relatorio') || "";
            localStorage.setItem('AID_Relatorio', logAtual + linha + "\n");

            // Se for erro, incrementa o contador global
            if (tipo === "erro") {
                let totalErros = parseInt(localStorage.getItem('AID_TotalErros') || 0);
                localStorage.setItem('AID_TotalErros', totalErros + 1);
            }
        }


        function verificarChute(numeroEscolhido) {
            totalTentativas++;
            atualizarContador();

            var tela = document.getElementById("tela-display");
            var sigma = document.getElementById("mensagem-sigma");

            if (numeroEscolhido === numeroSecreto) {
                registrarLog("[MISS√ÉO 1A] Sucesso! Senha quebrada (" + numeroSecreto + ") ap√≥s " + totalTentativas + " tentativas.","erro");
                // --- VIT√ìRIA ---
                tela.innerHTML = "ACESSO PERMITIDO!<br><small style='font-size:16px'>Senha: " + numeroSecreto + "</small>";
                tela.style.backgroundColor = "#00ff41"; 
                tela.style.color = "#000";
                
                if (totalTentativas === 1) {
                    sigma.innerText = "INCR√çVEL! De primeira! Clique abaixo para continuar.";
                } else {
                    registrarLog("[MISS√ÉO 1A] Falha. Tentativa incorreta: " + numeroEscolhido, "erro");
                    sigma.innerText = "Muito bem, Agente! Hackeado em " + totalTentativas + " tentativas.";
                }

                document.getElementById("teclado-numerico").style.display = "none";
                document.getElementById("btn-hack").style.display = "none";
                
                // MOSTRA O BOT√ÉO DE PROSSEGUIR
                document.getElementById("btn-proxima-fase").style.display = "block";

            } else {
                // --- ERRO ---
                ultimoChuteErrado = numeroEscolhido;
                tela.innerText = "ACESSO NEGADO";
                tela.style.backgroundColor = "#ff3333"; 
                
                ativarModoPedagogico();
            }
        }

        function ativarModoPedagogico() {
            document.getElementById("teclado-numerico").style.display = "none";
            document.getElementById("area-pergunta").style.display = "flex";
            document.getElementById("mensagem-sigma").innerText = "O sistema resetou! O fato de voc√™ ter errado o n√∫mero " + ultimoChuteErrado + " antes, muda sua chance agora?";
        }

        function verificarRespostaPedagogica(resposta) {
            var sigma = document.getElementById("mensagem-sigma");
            var tela = document.getElementById("tela-display");
            var areaPergunta = document.getElementById("area-pergunta");
            var teclado = document.getElementById("teclado-numerico");
            var btnHack = document.getElementById("btn-hack");

            if (resposta === 'igual') {
                tela.innerText = "RACIOC√çNIO CORRETO";
                tela.style.backgroundColor = "#003b00"; 
                
                sigma.innerHTML = "Excelente! Como recompensa, liberei o <strong>DECODIFICADOR</strong>.<br>Clique no bot√£o amarelo para descobrir a senha!";
                
                areaPergunta.style.display = "none";
                btnHack.style.display = "block";
            } else {
                sigma.innerText = "Negativo. Em eventos independentes, o passado n√£o importa. Tente de novo.";
            }
        }

        function revelarSenha() {
            var sigma = document.getElementById("mensagem-sigma");
            var btnHack = document.getElementById("btn-hack");
            var teclado = document.getElementById("teclado-numerico");

            sigma.innerHTML = "O Decodificador interceptou o sinal: <br><span class='texto-destaque'> A SENHA √â " + numeroSecreto + "</span>.<br>V√° em frente, digite e finalize a miss√£o.";

            btnHack.style.display = "none";
            teclado.style.display = "grid";
        }

        function irProximaFase() {
            window.location.href = "missao_1b.html";
        }
    </script>

    <script src="footer.js"></script>
</body>
</html>